library(fpp)
plot(BoxCox(usnetelec, lambda=lambda))
lambda <- BoxCox.lambda(usnetelec)
n <- ndiffs(usnetelec)
hist(BoxCox(usnetelec, lambda=lambda))
plot(cangas)
lambda <- BoxCox.lambda(usnetelec)
n <- ndiffs(usnetelec)
plot(diff(BoxCox(usnetelec, lambda=lambda), diff = n), col = "red")
plot(usnetelec)
plot(usgdp)
plot(mcopper)
plot(enplanements)
lambda <- BoxCox.lambda(enplanements)
n <- nsdiffs(enplanements)
plot(enplanements)
plot(diff(BoxCox(enplanements,lambda=lambda), diff = n), col = "red")
lambda <- BoxCox.lambda(enplanements)
n <- ndiffs(enplanements)
plot(enplanements)
plot(diff(BoxCox(enplanements,lambda=lambda), diff = n), col = "red")
lambda <- BoxCox.lambda(mcopper)
n <- nsdiffs(mcopper)
plot(mcopper)
plot(diff(BoxCox(mcopper,lambda=lambda), diff = n), col = "red")
lambda <- BoxCox.lambda(enplanements)
n <- ndiffs(enplanements)
plot(enplanements)
plot(diff(BoxCox(enplanements,lambda=lambda), diff = n), col = "red")
plot(visitors)
lambda <- BoxCox.lambda(visitors)
n <- ndiffs(visitors)
plot(visitors)
plot(diff(BoxCox(visitors,lambda=lambda), diff = n), col = "red")
lambda <- BoxCox.lambda(visitors)
n <- nsdiffs(visitors)
plot(visitors)
plot(diff(BoxCox(visitors,lambda=lambda), diff = n), col = "red")
plot(cangas)
data = read.csv2("retail.csv", header = TRUE)
duom <- data[,2]
duom <- ts(duom, frequency=12, start=c(1982,4))
lambda <- BoxCox.lambda(duom)
n <- ndiffs(duom)
plot(duom)
var(BoxCox(cangas,lambda=lambda))
plot(BoxCox(duom, lambda = lambda))
plot(BoxCox(diff(duom, diff = n),lambda=lambda), col = "red")
plot(e)
abline(0, 0, col = "green")
plot(visitors)
library(fpp)
data <- visitors
train <- window(data, end = 2000.99)
test <- window(data, start = 2001)
ets(train)
rmsea <- subset(accuracy(ets(train)), select = RMSE)
rmsea
k <- 48 # minimum size for training set
n <- length(visitors) # Total number of observations
e <- visitors*NA # Vector to record one-step forecast errors
for(i in 48:(n-1))
{
train <- ts(visitors[1:i],freq=12)
fit <- ets(train, "MAM", damped=FALSE)
fc <- forecast(fit,h=1)$mean
e[i] <- visitors[i+1]-fc
}
rmseb <- sqrt(mean(e^2,na.rm=TRUE))
rmseb
plot(e)
abline(0, 0, col = "green")
plot(visitors)
str(fit)
str(fit)$fitted
fit$fitted
lines(fit$fitted)
curve(fit$fitted, add = TRUE)
plot(visitors)
curve(fit$fitted, add = TRUE)
lines(fit$fitted)
lines(fit$fitted, add = TRUE)
plot(visitors)
plot(e)
abline(0, 0, col = "green")
plot(visitors)
rmsea
rmseb
train <- window(data, end = 2000.99)
test <- window(data, start = 2001)
ets(train)
rmsea <- subset(accuracy(ets(train)), select = RMSE)
rmsea
f <- ets(train)
fc <- forecast(f)$mean
fc4 <- forecast(f)$mean
fc4 <- forecast(f)$mean
plot(visitors)
fc4 <- forecast(f)$mean
lines(fc4)
lines(fc4, col = "red")
fc4 <- forecast(f, h = 20)$mean
lines(fc4, col = "red")
fc4 <- forecast(f, h = 200)$mean
lines(fc4, col = "red")
Acf(diff(BoxCox(enplanements,lambda=lambda), diff = n), col = "red")
lambda <- BoxCox.lambda(enplanements)
n <- nsdiffs(enplanements)
plot(enplanements)
plot(diff(BoxCox(enplanements,lambda=lambda), diff = n), col = "red")
Acf(diff(BoxCox(enplanements,lambda=lambda), diff = n), col = "red")
?kpss.test()
lambda <- BoxCox.lambda(enplanements)
n <- nsdiffs(enplanements)
plot(enplanements)
plot(diff(BoxCox(enplanements,lambda=lambda), diff = n), col = "red")
Acf(diff(BoxCox(enplanements,lambda=lambda), diff = n), col = "red")
kpss.test(diff(BoxCox(enplanements,lambda=lambda), diff = n))
PP.test(diff(BoxCox(enplanements,lambda=lambda), diff = n))
?PP.test
adf.test(diff(BoxCox(enplanements,lambda=lambda), diff = n))
?adf.test()
?kpss.test()
kpss.test(diff(BoxCox(usnetelec,lambda=lambda), diff = n))#testas,
lambda <- BoxCox.lambda(usnetelec)
n <- ndiffs(usnetelec)
plot(usnetelec)#duomenų grafikas
plot(diff(BoxCox(usnetelec, lambda=lambda), diff = n), col = "red")#duomenų po transformacijos ir diferencijavimo grafikas
kpss.test(diff(BoxCox(usnetelec,lambda=lambda), diff = n))#testas,
plot(visitors)
ets(train)
f <- ets(train)
fc4 <- forecast(f, h = 200)$mean
lines(fc4, col = "red")
rmsea <- subset(accuracy(ets(train)), select = RMSE)
rmsea
library(fpp)
data <- visitors
train <- window(data, end = 2000.99)
test <- window(data, start = 2001)
lambda <- BoxCox.lambda(usnetelec)
n <- ndiffs(usnetelec)
plot(usnetelec)
plot(diff(BoxCox(usnetelec, lambda=lambda), diff = n), col = "red")
kpss.test(diff(BoxCox(usnetelec,lambda=lambda), diff = n))#testas
lambda <- BoxCox.lambda(usnetelec)
n <- ndiffs(usnetelec)
plot(usnetelec)
plot(diff(BoxCox(usnetelec, lambda=lambda), diff = 2), col = "red")
kpss.test(diff(BoxCox(usnetelec,lambda=lambda), diff = n))#testas
library(fpp)
library(fpp)
lambda <- BoxCox.lambda(usnetelec)
n <- ndiffs(usnetelec)
plot(usnetelec)
plot(diff(BoxCox(usnetelec, lambda=lambda), diff = 2), col = "red")
kpss.test(diff(BoxCox(usnetelec,lambda=lambda), diff = n))#testas
lambda <- BoxCox.lambda(usnetelec)
n <- ndiffs(usnetelec)
plot(usnetelec)
plot(diff(BoxCox(usnetelec, lambda=lambda), diff = 2), col = "red")
kpss.test(diff(BoxCox(usnetelec,lambda=lambda), diff = 2))#testas
lambda <- BoxCox.lambda(usgdp)
n <- ndiffs(usgdp)
plot(usgdp)
plot(diff(BoxCox(usgdp,lambda=lambda), diff = n), col = "red")
kpss.test(diff(BoxCox(enplanements,lambda=lambda), diff = n))
lambda <- BoxCox.lambda(usgdp)
n <- ndiffs(usgdp)
plot(usgdp)
plot(diff(BoxCox(usgdp,lambda=lambda), diff = n), col = "red")
kpss.test(diff(BoxCox(usgdp,lambda=lambda), diff = n))
lambda <- BoxCox.lambda(mcopper)
n <- ndiffs(mcopper)
plot(mcopper)
plot(diff(BoxCox(mcopper,lambda=lambda), diff = n), col = "red")
kpss.test(diff(BoxCox(mcopper,lambda=lambda), diff = n))
lambda <- BoxCox.lambda(enplanements)
n <- nsdiffs(enplanements)
plot(enplanements)
plot(diff(BoxCox(enplanements,lambda=lambda), diff = n), col = "red")
kpss.test(diff(BoxCox(enplanements,lambda=lambda), diff = n))
lambda <- BoxCox.lambda(visitors)
n <- nsdiffs(visitors)
plot(visitors)
plot(diff(BoxCox(visitors,lambda=lambda), diff = n), col = "red")
kpss.test(diff(BoxCox(visitors,lambda=lambda), diff = n))
lambda <- BoxCox.lambda(duom)
n <- ndiffs(duom)
plot(duom)
var(BoxCox(cangas,lambda=lambda))
plot(BoxCox(duom, lambda = lambda))
plot(BoxCox(diff(duom, diff = n),lambda=lambda), col = "red")
data = read.csv2("retail.csv", header = TRUE)
duomenys <- data[,2]#naudosime tik vieną duomenų stulpelį
duom <- ts(duomenys, frequency=12, start=c(1982,4))
lambda <- BoxCox.lambda(duom)
n <- ndiffs(duom)
plot(duom)
var(BoxCox(cangas,lambda=lambda))
plot(BoxCox(duom, lambda = lambda))
plot(BoxCox(diff(duom, diff = n),lambda=lambda), col = "red")
plot(diff(BoxCox(duom,lambda = lambda), diff = n), col = "red")
kpss.test(diff(BoxCox(duom,lambda=lambda), diff = n))
