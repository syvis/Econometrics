sum(is.na(data$Amzius))
cor(data$Amzius, data$Stazas, use = "pairwise.complete.obs")
data[data[, "Blaivumas"] %in% c("Apsvaiges nuo narkotiniu, psichotropiniu ar kitu psichika veikianciu medziagu", "Atsisake buti patikrintas", "Neblaivus"), "Blaivumas"] <- "Neblaivus"
data[data[, "Blaivumas"] == "Blaivus", "Blaivumas"] <- "Blaivus"
data$Blaivumas <- factor(data$Blaivumas)
table(data$Blaivumas)
table(data$Meteorologines_salygos)
data[data[, "Meteorologines_salygos"] == "Lijundra", "Meteorologines_salygos"] <- "Lietus"
data[data[, "Meteorologines_salygos"] == "Puga", "Meteorologines_salygos"] <- "Sniegas, krusa"
data$Meteorologines_salygos <- factor(data$Meteorologines_salygos)
table(data$Meteorologines_salygos)
table(data$Dangos_bukle)
table(data$Dangos_bukle)
table(data$Dangos_rusis)
sum(data$Meteorologines_salygos == "Giedra", na.rm=T))
sum(data$Meteorologines_salygos == "Giedra", na.rm=T))
metiniai <- summarise(by_year,
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum(data$Paros_metas == "Diena", na.rm=T), sum(data$Lytis == "Moteris", na.rm=T), sum(data$Dangos_rusis == "Asfaltbetonis, cementbetonis", na.rm=T), sum(data$Dangos_rusis == "zvyrkelis", na.rm=T), sum(data$Dangos_bukle == "slapia", na.rm=T), sum(data$Meteorologines_salygos == "Giedra", na.rm=T))
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum(data$Paros_metas == "Diena", na.rm=T), sum(data$Lytis == "Moteris", na.rm=T), sum(data$Dangos_rusis == "Asfaltbetonis, cementbetonis", na.rm=T), sum(data$Dangos_rusis == "zvyrkelis", na.rm=T), sum(data$Dangos_bukle == "slapia", na.rm=T), sum(data$Meteorologines_salygos == "Giedra", na.rm=T))
by_year <- group_by(data, format(as.Date(data$Data, format="%Y-%m-%d"),"%Y"), Vieta)
rawdata <- read.csv2("2003-2015.csv", header = T)
gyventojai <- read.csv2("gyventojai.csv", header = T, skip = 1)
kor <- read.csv2("koreliacijos.csv", header = T)
rawdata <- read.csv2("2003-2015.csv", header = T)
gyventojai <- read.csv2("gyventojai.csv", header = T, skip = 1)
kor <- read.csv2("koreliacijos.csv", header = T)
miestai <- c("Vilniaus m. sav.", "Kauno m. sav.", "Klaipedos m. sav.", "Siauliu m. sav.", "Panevezio m. sav.")
data <- subset(rawdata, Vieta %in% miestai)
Amzius <- as.numeric(format(Sys.Date(), format="%Y")) - as.numeric(format(as.Date(data$Gimimo_data, format="%Y"), format = "%Y"))
data <- data[,-22]
data <- cbind(data, Amzius)
head(data$Amzius)
View(data)
rawdata <- read.csv2("2003-2015.csv", header = T)
gyventojai <- read.csv2("gyventojai.csv", header = T, skip = 1)
kor <- read.csv2("koreliacijos.csv", header = T)
rawdata <- read.csv2("2003-2015.csv", header = T)
gyventojai <- read.csv2("gyventojai.csv", header = T, skip = 1)
kor <- read.csv2("koreliacijos.csv", header = T)
miestai <- c("Vilniaus m. sav.", "Kauno m. sav.", "Klaipedos m. sav.", "Siauliu m. sav.", "Panevezio m. sav.")
data <- subset(rawdata, Vieta %in% miestai)
Amzius <- as.numeric(format(Sys.Date(), format="%Y")) - as.numeric(format(as.Date(data$Gimimo_data, format="%Y"), format = "%Y"))
data <- data[,-"Gimimo_data"]
data <- cbind(data, Amzius)
data <- data[,-c("Gimimo_data")]
data[data[, "Blaivumas"] %in% c("Apsvaiges nuo narkotiniu, psichotropiniu ar kitu psichika veikianciu medziagu", "Atsisake buti patikrintas", "Neblaivus"), "Blaivumas"] <- "Neblaivus"
data[data[, "Blaivumas"] == "Blaivus", "Blaivumas"] <- "Blaivus"
data$Blaivumas <- factor(data$Blaivumas)
table(data$Blaivumas)
data[data[, "Blaivumas"] %in% c("Apsvaiges nuo narkotiniu, psichotropiniu ar kitu psichika veikianciu medziagu", "Atsisake buti patikrintas", "Neblaivus"), "Blaivumas"] <- "Neblaivus"
data$Blaivumas <- factor(data$Blaivumas)
table(data$Blaivumas)
data[data[, "Meteorologines_salygos"] == "Lijundra", "Meteorologines_salygos"] <- "Lietus"
data[data[, "Meteorologines_salygos"] == "Puga", "Meteorologines_salygos"] <- "Sniegas, krusa"
data$Meteorologines_salygos <- factor(data$Meteorologines_salygos)
table(data$Meteorologines_salygos)
salinamieji <- c("Lytis", "Apgadintu_transporto_priemoniu_skaicius", "Pilietybe", "Neigalumas", "Blaivumas", "Amzius")
ndata <- data[complete.cases(data[salinamieji]),]
sapply(lapply(ndata, is.na), sum)
tukst <- gyventojai[,3]/1000
gyventojai <- cbind(gyventojai, tukst)
by_month <- group_by(ndata, format(as.Date(ndata$Data, format="%Y-%m-%d"),"%Y-%m"), Vieta)
agreguoti <- summarise(by_month, sum(Kaltas), sum(Dalyviu_skaicius), sum(Suzeistu_skaicius), sum(Zuvusiu_skaicius))
colnames(agreguoti) <- list("Data", "Vieta", "Ivykiai", "Dalyviai", "Suzeisti", "Zuve")
ivykiusk <- function(i)
ts(agreguoti[agreguoti$Vieta == i, "Ivykiai"], start=c(2003,1), frequency = 12)
gyvsk <- function(i)
ts(rep(gyventojai[gyventojai$Vieta == i, "Visi"], each = 12), start = c(2003,1), frequency = 12)
ivykiai <- sapply(miestai, ivykiusk)
names(ivykiai)<-sprintf(miestai)
gyven <- sapply(miestai, gyvsk)
names(gyven)<-sprintf(miestai)
tukst <- function(i)
ivykiai[,i] * 1000 / gyven[,i]
tukstgyv <- ts(sapply(miestai, tukst), start = c(2003,1), frequency = 12)
names(tukstgyv)<-sprintf(miestai)
gyven[,1]
ivykiai[,1]
View(agreguoti)
ts(agreguoti[agreguoti$Vieta == i, "Ivykiai"], start=c(2003,1), frequency = 12)
ts(agreguoti[agreguoti$Vieta == "Vilniaus m. sav.", "Ivykiai"], start=c(2003,1), frequency = 12)
library(fpp)
library(dplyr)
rawdata <- read.csv2("2003-2015.csv", header = T)
gyventojai <- read.csv2("gyventojai.csv", header = T, skip = 1)
kor <- read.csv2("koreliacijos.csv", header = T)
miestai <- c("Vilniaus m. sav.", "Kauno m. sav.", "Klaipedos m. sav.", "Siauliu m. sav.", "Panevezio m. sav.")
data <- subset(rawdata, Vieta %in% miestai)
Amzius <- as.numeric(format(Sys.Date(), format="%Y")) - as.numeric(format(as.Date(data$Gimimo_data, format="%Y"), format = "%Y"))
data <- cbind(data, Amzius)
data[data[, "Blaivumas"] %in% c("Apsvaiges nuo narkotiniu, psichotropiniu ar kitu psichika veikianciu medziagu", "Atsisake buti patikrintas", "Neblaivus"), "Blaivumas"] <- "Neblaivus"
data$Blaivumas <- factor(data$Blaivumas)
table(data$Blaivumas)
data[data[, "Meteorologines_salygos"] == "Lijundra", "Meteorologines_salygos"] <- "Lietus"
data[data[, "Meteorologines_salygos"] == "Puga", "Meteorologines_salygos"] <- "Sniegas, krusa"
data$Meteorologines_salygos <- factor(data$Meteorologines_salygos)
table(data$Meteorologines_salygos)
tukst <- gyventojai[,3]/1000
gyventojai <- cbind(gyventojai, tukst)
by_month <- group_by(data, format(as.Date(data$Data, format="%Y-%m-%d"),"%Y-%m"), Vieta)
agreguoti <- summarise(by_month, sum(Kaltas), sum(Dalyviu_skaicius), sum(Suzeistu_skaicius), sum(Zuvusiu_skaicius))
colnames(agreguoti) <- list("Data", "Vieta", "Ivykiai", "Dalyviai", "Suzeisti", "Zuve")
ivykiusk <- function(i)
ts(agreguoti[agreguoti$Vieta == "Vilniaus m. sav.", "Ivykiai"], start=c(2003,1), frequency = 12)
gyvsk <- function(i)
ts(rep(gyventojai[gyventojai$Vieta == i, "Visi"], each = 12), start = c(2003,1), frequency = 12)
ivykiai <- sapply(miestai, ivykiusk)
names(ivykiai)<-sprintf(miestai)
gyven <- sapply(miestai, gyvsk)
names(gyven)<-sprintf(miestai)
tukst <- function(i)
ivykiai[,1] * 1000 / gyven[,1]
tukstgyv <- ts(sapply(miestai, tukst), start = c(2003,1), frequency = 12)
names(tukstgyv)<-sprintf(miestai)
plot(0, type = "n", xlim = c(2003,2015), ylim = c(0,0.3), yaxs="i", xaxs="i", main = "Įvykių skaičius 1000-iui gyventojų", ylab = "Įvykių sk. 1000 gyv.", xlab = "Laikas", axes=F)
par(xaxp=c(2003, 2015, 12), yaxp=c(0, 0.3, 6))
axis(1)
axis(2)
for(i in 1:5)
lines(tukstgyv[,i], col = i, lwd = 1)
legend("topright", col = c(1:5), lty = 1, lwd = 1, legend = c("Vilnius", "Kaunas", "Klaipėda", "Šiauliai", "Panevėžys"), pt.cex = 1, cex = 0.45, text.width = 1)
ivykiusk <- function(i)
ts(agreguoti[agreguoti$Vieta == "Vilniaus m. sav.", "Ivykiai"], start=c(2003,1), frequency = 12)
gyvsk <- function(i)
ts(rep(gyventojai[gyventojai$Vieta == i, "Visi"], each = 12), start = c(2003,1), frequency = 12)
ivykiai <- sapply(miestai, ivykiusk)
names(ivykiai)<-sprintf(miestai)
gyven <- sapply(miestai, gyvsk)
names(gyven)<-sprintf(miestai)
tukst <- function(i)
ivykiai[,i] * 1000 / gyven[,i]
tukstgyv <- ts(sapply(miestai, tukst), start = c(2003,1), frequency = 12)
names(tukstgyv)<-sprintf(miestai)
plot(0, type = "n", xlim = c(2003,2015), ylim = c(0,0.3), yaxs="i", xaxs="i", main = "Įvykių skaičius 1000-iui gyventojų", ylab = "Įvykių sk. 1000 gyv.", xlab = "Laikas", axes=F)
par(xaxp=c(2003, 2015, 12), yaxp=c(0, 0.3, 6))
axis(1)
axis(2)
for(i in 1:5)
lines(tukstgyv[,i], col = i, lwd = 1)
legend("topright", col = c(1:5), lty = 1, lwd = 1, legend = c("Vilnius", "Kaunas", "Klaipėda", "Šiauliai", "Panevėžys"), pt.cex = 1, cex = 0.45, text.width = 1)
rawdata <- read.csv2("2003-2015.csv", header = T)
gyventojai <- read.csv2("gyventojai.csv", header = T, skip = 1)
kor <- read.csv2("koreliacijos.csv", header = T)
rawdata <- read.csv2("2003-2015.csv", header = T)
gyventojai <- read.csv2("gyventojai.csv", header = T, skip = 1)
kor <- read.csv2("koreliacijos.csv", header = T)
miestai <- c("Vilniaus m. sav.", "Kauno m. sav.", "Klaipedos m. sav.", "Siauliu m. sav.", "Panevezio m. sav.")
data <- subset(rawdata, Vieta %in% miestai)
Amzius <- as.numeric(format(Sys.Date(), format="%Y")) - as.numeric(format(as.Date(data$Gimimo_data, format="%Y"), format = "%Y"))
data <- cbind(data, Amzius)
data[data[, "Blaivumas"] %in% c("Apsvaiges nuo narkotiniu, psichotropiniu ar kitu psichika veikianciu medziagu", "Atsisake buti patikrintas", "Neblaivus"), "Blaivumas"] <- "Neblaivus"
data$Blaivumas <- factor(data$Blaivumas)
table(data$Blaivumas)
data[data[, "Meteorologines_salygos"] == "Lijundra", "Meteorologines_salygos"] <- "Lietus"
data[data[, "Meteorologines_salygos"] == "Puga", "Meteorologines_salygos"] <- "Sniegas, krusa"
data$Meteorologines_salygos <- factor(data$Meteorologines_salygos)
table(data$Meteorologines_salygos)
tukst <- gyventojai[,3]/1000
gyventojai <- cbind(gyventojai, tukst)
by_month <- group_by(data, format(as.Date(data$Data, format="%Y-%m-%d"),"%Y-%m"), Vieta)
agreguoti <- summarise(by_month, sum(Kaltas), sum(Dalyviu_skaicius), sum(Suzeistu_skaicius), sum(Zuvusiu_skaicius))
colnames(agreguoti) <- list("Data", "Vieta", "Ivykiai", "Dalyviai", "Suzeisti", "Zuve")
ivykiusk <- function(i)
ts(agreguoti[agreguoti$Vieta == i, "Ivykiai"], start=c(2003,1), frequency = 12)
gyvsk <- function(i)
ts(rep(gyventojai[gyventojai$Vieta == i, "Visi"], each = 12), start = c(2003,1), frequency = 12)
ivykiai <- sapply(miestai, ivykiusk)
names(ivykiai)<-sprintf(miestai)
gyven <- sapply(miestai, gyvsk)
names(gyven)<-sprintf(miestai)
tukst <- function(i)
ivykiai[,i] * 1000 / gyven[,i]
tukstgyv <- ts(sapply(miestai, tukst), start = c(2003,1), frequency = 12)
names(tukstgyv)<-sprintf(miestai)
plot(0, type = "n", xlim = c(2003,2015), ylim = c(0,0.3), yaxs="i", xaxs="i", main = "Įvykių skaičius 1000-iui gyventojų", ylab = "Įvykių sk. 1000 gyv.", xlab = "Laikas", axes=F)
par(xaxp=c(2003, 2015, 12), yaxp=c(0, 0.3, 6))
axis(1)
axis(2)
for(i in 1:5)
lines(tukstgyv[,i], col = i, lwd = 1)
legend("topright", col = c(1:5), lty = 1, lwd = 1, legend = c("Vilnius", "Kaunas", "Klaipėda", "Šiauliai", "Panevėžys"), pt.cex = 1, cex = 0.45, text.width = 1)
by_year <- group_by(data, format(as.Date(data$Data, format="%Y-%m-%d"),"%Y"), Vieta)
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum(data$Paros_metas == "Diena", na.rm=T), sum(data$Lytis == "Moteris", na.rm=T), sum(data$Dangos_rusis == "Asfaltbetonis, cementbetonis", na.rm=T), sum(data$Dangos_rusis == "zvyrkelis", na.rm=T), sum(data$Dangos_bukle == "slapia", na.rm=T), sum(data$Meteorologines_salygos == "Giedra", na.rm=T))
View(metiniai)
colnames(metiniai) <- list("Data", "Vieta", "Ivykiai", "Neblaivus", "Diena", "Moteris", "Asfaltas", "Zvyras", "Slapia_danga", "Giedra")
View(metiniai)
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus"), sum(data$Paros_metas == "Diena", na.rm=T), sum(data$Lytis == "Moteris", na.rm=T), sum(data$Dangos_rusis == "Asfaltbetonis, cementbetonis", na.rm=T), sum(data$Dangos_rusis == "zvyrkelis", na.rm=T), sum(data$Dangos_bukle == "slapia", na.rm=T), sum(data$Meteorologines_salygos == "Giedra", na.rm=T))
colnames(metiniai) <- list("Data", "Vieta", "Ivykiai", "Neblaivus", "Diena", "Moteris", "Asfaltas", "Zvyras", "Slapia_danga", "Giedra")
View(metiniai)
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus"), sum(if(data$Paros_metas == "Diena")), sum(data$Lytis == "Moteris", na.rm=T), sum(data$Dangos_rusis == "Asfaltbetonis, cementbetonis", na.rm=T), sum(data$Dangos_rusis == "zvyrkelis", na.rm=T), sum(data$Dangos_bukle == "slapia", na.rm=T), sum(data$Meteorologines_salygos == "Giedra", na.rm=T))
sum(data$Blaivumas == "Neblaivus", na.rm=T)
by_year <- group_by(data, format(as.Date(data$Data, format="%Y-%m-%d"),"%Y"))
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum(data$Paros_metas == "Diena", na.rm=T), sum(data$Lytis == "Moteris", na.rm=T), sum(data$Dangos_rusis == "Asfaltbetonis, cementbetonis", na.rm=T), sum(data$Dangos_rusis == "zvyrkelis", na.rm=T), sum(data$Dangos_bukle == "slapia", na.rm=T), sum(data$Meteorologines_salygos == "Giedra", na.rm=T))
by_year <- group_by(data, format(as.Date(data$Data, format="%Y-%m-%d"),"%Y"), Vieta)
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum(data$Paros_metas == "Diena", na.rm=T), sum(data$Lytis == "Moteris", na.rm=T), sum(data$Dangos_rusis == "Asfaltbetonis, cementbetonis", na.rm=T), sum(data$Dangos_rusis == "zvyrkelis", na.rm=T), sum(data$Dangos_bukle == "slapia", na.rm=T), sum(data$Meteorologines_salygos == "Giedra", na.rm=T))
colnames(metiniai) <- list("Data", "Vieta", "Ivykiai", "Neblaivus", "Diena", "Moteris", "Asfaltas", "Zvyras", "Slapia_danga", "")
sum(as.numeric(data$Blaivumas == "Neblaivus"))
sapply(lapply(ndata, is.na), sum)
sapply(lapply(data, is.na), sum)
sum(data$Meteorologines_salygos == "Giedra")
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum(data$Paros_metas == "Diena", na.rm=T), sum(data$Lytis == "Moteris", na.rm=T), sum(data$Dangos_rusis == "Asfaltbetonis, cementbetonis", na.rm=T), sum(data$Dangos_rusis == "zvyrkelis", na.rm=T), sum(data$Dangos_bukle == "slapia", na.rm=T), sum(data$Meteorologines_salygos == "Giedra"))
colnames(metiniai) <- list("Data", "Vieta", "Ivykiai", "Neblaivus", "Diena", "Moteris", "Asfaltas", "Zvyras", "Slapia_danga", "")
colnames(metiniai) <- list("Data", "Vieta", "Ivykiai", "Neblaivus", "Diena", "Moteris", "Asfaltas", "Zvyras", "Slapia_danga", "Giedra")
sum(data$Paros_metas == "Diena")
sum(data$Lytis == "Moteris")
sum(data$Dangos_rusis == "Asfaltbetonis, cementbetonis")
sum(data$Dangos_rusis == "zvyrkelis")
sum(data$Dangos_bukle == "slapia")
diena <- data$Paros_metas=="Diena"
diena <- sum(data$Paros_metas=="Diena")
diena <- data$Paros_metas=="Diena"
diena <- data$Paros_metas=="Diena" * 1
diena <- data$Paros_metas=="Diena"
diena * 1
diena <- diena * 1
diena <- data$Paros_metas=="Diena"
diena <- diena * 1
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum((data$Paros_metas == "Diena") * 1), sum(data$Lytis == "Moteris", na.rm=T), sum(data$Dangos_rusis == "Asfaltbetonis, cementbetonis"), sum(data$Dangos_rusis == "zvyrkelis"), sum(data$Dangos_bukle == "slapia"), sum(data$Meteorologines_salygos == "Giedra"))
View(metiniai)
colnames(metiniai) <- list("Data", "Vieta", "Ivykiai", "Neblaivus", "Diena", "Moteris", "Asfaltas", "Zvyras", "Slapia_danga", "Giedra")
diena <- data$Paros_metas=="Diena"
diena <- diena * 1
data <- cbind(data,diena)
View(data)
by_year <- group_by(data, format(as.Date(data$Data, format="%Y-%m-%d"),"%Y"), Vieta)
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum(diena), sum(data$Lytis == "Moteris", na.rm=T), sum(data$Dangos_rusis == "Asfaltbetonis, cementbetonis"), sum(data$Dangos_rusis == "zvyrkelis"), sum(data$Dangos_bukle == "slapia"), sum(data$Meteorologines_salygos == "Giedra"))
colnames(metiniai) <- list("Data", "Vieta", "Ivykiai", "Neblaivus", "Diena", "Moteris", "Asfaltas", "Zvyras", "Slapia_danga", "Giedra")
lyginamivyk <- sapply(tukstgyv, median)
M <- as.table(rbind(tukstgyv[,1], tukstgyv[,2]))
chisq.test(lyginamivyk)
View(metiniai)
moteris <- data$Lytis == "Moteris"
moteris <- moteris * 1
danga <- data$Dangos_rusis == "Asfaltbetonis, cementbetonis"
danga <- danga * 1
zvyras <- data$Dangos_rusis == "zvyrkelis"
zvyras <- zvyras * 1
sum(zvyras)
diena <- data$Paros_metas == "Diena"
diena <- diena * 1
moteris <- data$Lytis == "Moteris"
moteris <- moteris * 1
asfaltas <- data$Dangos_rusis == "Asfaltbetonis, cementbetonis"
asfaltas <- danga * 1
zvyras <- data$Dangos_rusis == "zvyrkelis"
zvyras <- zvyras * 1
slapia <- data$Dangos_bukle == "slapia"
slapia <- slapia * 1
giedra <- data$Meteorologines_salygos == "Giedra"
giedra <- giedra * 1
data <- cbind(data, diena, moteris, asfaltas, zvyras, slapia, giedra)
by_year <- group_by(data, format(as.Date(data$Data, format="%Y-%m-%d"),"%Y"), Vieta)
by_year <- group_by(data, format(as.Date(data$Data, format="%Y-%m-%d"),"%Y"), Vieta)
rawdata <- read.csv2("2003-2015.csv", header = T)
gyventojai <- read.csv2("gyventojai.csv", header = T, skip = 1)
kor <- read.csv2("koreliacijos.csv", header = T)
rawdata <- read.csv2("2003-2015.csv", header = T)
gyventojai <- read.csv2("gyventojai.csv", header = T, skip = 1)
kor <- read.csv2("koreliacijos.csv", header = T)
miestai <- c("Vilniaus m. sav.", "Kauno m. sav.", "Klaipedos m. sav.", "Siauliu m. sav.", "Panevezio m. sav.")
data <- subset(rawdata, Vieta %in% miestai)
Amzius <- as.numeric(format(Sys.Date(), format="%Y")) - as.numeric(format(as.Date(data$Gimimo_data, format="%Y"), format = "%Y"))
data <- cbind(data, Amzius)
sum(is.na(data$Stazas))
sum(is.na(data$Amzius))
cor(data$Amzius, data$Stazas, use = "pairwise.complete.obs")
data[data[, "Blaivumas"] %in% c("Apsvaiges nuo narkotiniu, psichotropiniu ar kitu psichika veikianciu medziagu", "Atsisake buti patikrintas", "Neblaivus"), "Blaivumas"] <- "Neblaivus"
data$Blaivumas <- factor(data$Blaivumas)
table(data$Blaivumas)
data[data[, "Meteorologines_salygos"] == "Lijundra", "Meteorologines_salygos"] <- "Lietus"
data[data[, "Meteorologines_salygos"] == "Puga", "Meteorologines_salygos"] <- "Sniegas, krusa"
data$Meteorologines_salygos <- factor(data$Meteorologines_salygos)
table(data$Meteorologines_salygos)
tukst <- gyventojai[,3]/1000
gyventojai <- cbind(gyventojai, tukst)
by_month <- group_by(data, format(as.Date(data$Data, format="%Y-%m-%d"),"%Y-%m"), Vieta)
agreguoti <- summarise(by_month, sum(Kaltas), sum(Dalyviu_skaicius), sum(Suzeistu_skaicius), sum(Zuvusiu_skaicius))
colnames(agreguoti) <- list("Data", "Vieta", "Ivykiai", "Dalyviai", "Suzeisti", "Zuve")
ivykiusk <- function(i)
ts(agreguoti[agreguoti$Vieta == i, "Ivykiai"], start=c(2003,1), frequency = 12)
gyvsk <- function(i)
ts(rep(gyventojai[gyventojai$Vieta == i, "Visi"], each = 12), start = c(2003,1), frequency = 12)
ivykiai <- sapply(miestai, ivykiusk)
names(ivykiai)<-sprintf(miestai)
gyven <- sapply(miestai, gyvsk)
names(gyven)<-sprintf(miestai)
tukst <- function(i)
ivykiai[,i] * 1000 / gyven[,i]
tukstgyv <- ts(sapply(miestai, tukst), start = c(2003,1), frequency = 12)
names(tukstgyv)<-sprintf(miestai)
plot(0, type = "n", xlim = c(2003,2015), ylim = c(0,0.3), yaxs="i", xaxs="i", main = "Įvykių skaičius 1000-iui gyventojų", ylab = "Įvykių sk. 1000 gyv.", xlab = "Laikas", axes=F)
par(xaxp=c(2003, 2015, 12), yaxp=c(0, 0.3, 6))
axis(1)
axis(2)
for(i in 1:5)
lines(tukstgyv[,i], col = i, lwd = 1)
legend("topright", col = c(1:5), lty = 1, lwd = 1, legend = c("Vilnius", "Kaunas", "Klaipėda", "Šiauliai", "Panevėžys"), pt.cex = 1, cex = 0.45, text.width = 1)
diena <- data$Paros_metas == "Diena"
diena <- diena * 1
moteris <- data$Lytis == "Moteris"
moteris <- moteris * 1
asfaltas <- data$Dangos_rusis == "Asfaltbetonis, cementbetonis"
asfaltas <- danga * 1
zvyras <- data$Dangos_rusis == "zvyrkelis"
zvyras <- zvyras * 1
slapia <- data$Dangos_bukle == "slapia"
slapia <- slapia * 1
giedra <- data$Meteorologines_salygos == "Giedra"
giedra <- giedra * 1
data <- cbind(data, diena, moteris, asfaltas, zvyras, slapia, giedra)
diena <- data$Paros_metas == "Diena"
diena <- diena * 1
moteris <- data$Lytis == "Moteris"
moteris <- moteris * 1
asfaltas <- data$Dangos_rusis == "Asfaltbetonis, cementbetonis"
asfaltas <- asfaltas * 1
zvyras <- data$Dangos_rusis == "zvyrkelis"
zvyras <- zvyras * 1
slapia <- data$Dangos_bukle == "slapia"
slapia <- slapia * 1
giedra <- data$Meteorologines_salygos == "Giedra"
giedra <- giedra * 1
data <- cbind(data, diena, moteris, asfaltas, zvyras, slapia, giedra)
rawdata <- read.csv2("2003-2015.csv", header = T)
gyventojai <- read.csv2("gyventojai.csv", header = T, skip = 1)
kor <- read.csv2("koreliacijos.csv", header = T)
miestai <- c("Vilniaus m. sav.", "Kauno m. sav.", "Klaipedos m. sav.", "Siauliu m. sav.", "Panevezio m. sav.")
data <- subset(rawdata, Vieta %in% miestai)
Amzius <- as.numeric(format(Sys.Date(), format="%Y")) - as.numeric(format(as.Date(data$Gimimo_data, format="%Y"), format = "%Y"))
data <- cbind(data, Amzius)
sum(is.na(data$Stazas))
sum(is.na(data$Amzius))
cor(data$Amzius, data$Stazas, use = "pairwise.complete.obs")
data[data[, "Blaivumas"] %in% c("Apsvaiges nuo narkotiniu, psichotropiniu ar kitu psichika veikianciu medziagu", "Atsisake buti patikrintas", "Neblaivus"), "Blaivumas"] <- "Neblaivus"
data$Blaivumas <- factor(data$Blaivumas)
table(data$Blaivumas)
data[data[, "Meteorologines_salygos"] == "Lijundra", "Meteorologines_salygos"] <- "Lietus"
data[data[, "Meteorologines_salygos"] == "Puga", "Meteorologines_salygos"] <- "Sniegas, krusa"
data$Meteorologines_salygos <- factor(data$Meteorologines_salygos)
table(data$Meteorologines_salygos)
data[data[, "Meteorologines_salygos"] == "Lijundra", "Meteorologines_salygos"] <- "Lietus"
data[data[, "Meteorologines_salygos"] == "Puga", "Meteorologines_salygos"] <- "Sniegas, krusa"
data$Meteorologines_salygos <- factor(data$Meteorologines_salygos)
table(data$Meteorologines_salygos)
tukst <- gyventojai[,3]/1000
gyventojai <- cbind(gyventojai, tukst)
by_month <- group_by(data, format(as.Date(data$Data, format="%Y-%m-%d"),"%Y-%m"), Vieta)
agreguoti <- summarise(by_month, sum(Kaltas), sum(Dalyviu_skaicius), sum(Suzeistu_skaicius), sum(Zuvusiu_skaicius))
colnames(agreguoti) <- list("Data", "Vieta", "Ivykiai", "Dalyviai", "Suzeisti", "Zuve")
ivykiusk <- function(i)
ts(agreguoti[agreguoti$Vieta == i, "Ivykiai"], start=c(2003,1), frequency = 12)
gyvsk <- function(i)
ts(rep(gyventojai[gyventojai$Vieta == i, "Visi"], each = 12), start = c(2003,1), frequency = 12)
ivykiai <- sapply(miestai, ivykiusk)
names(ivykiai)<-sprintf(miestai)
gyven <- sapply(miestai, gyvsk)
names(gyven)<-sprintf(miestai)
tukst <- function(i)
ivykiai[,i] * 1000 / gyven[,i]
tukstgyv <- ts(sapply(miestai, tukst), start = c(2003,1), frequency = 12)
names(tukstgyv)<-sprintf(miestai)
plot(0, type = "n", xlim = c(2003,2015), ylim = c(0,0.3), yaxs="i", xaxs="i", main = "Įvykių skaičius 1000-iui gyventojų", ylab = "Įvykių sk. 1000 gyv.", xlab = "Laikas", axes=F)
par(xaxp=c(2003, 2015, 12), yaxp=c(0, 0.3, 6))
axis(1)
axis(2)
for(i in 1:5)
lines(tukstgyv[,i], col = i, lwd = 1)
legend("topright", col = c(1:5), lty = 1, lwd = 1, legend = c("Vilnius", "Kaunas", "Klaipėda", "Šiauliai", "Panevėžys"), pt.cex = 1, cex = 0.45, text.width = 1)
diena <- data$Paros_metas == "Diena"
diena <- diena * 1
moteris <- data$Lytis == "Moteris"
moteris <- moteris * 1
asfaltas <- data$Dangos_rusis == "Asfaltbetonis, cementbetonis"
asfaltas <- asfaltas * 1
zvyras <- data$Dangos_rusis == "zvyrkelis"
zvyras <- zvyras * 1
slapia <- data$Dangos_bukle == "slapia"
slapia <- slapia * 1
giedra <- data$Meteorologines_salygos == "Giedra"
giedra <- giedra * 1
data <- cbind(data, diena, moteris, asfaltas, zvyras, slapia, giedra)
by_year <- group_by(data, format(as.Date(data$Data, format="%Y-%m-%d"),"%Y"), Vieta)
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum(diena), sum(moteris), sum(asfaltas), sum(zvyras), sum(slapia), sum(giedra))
colnames(metiniai) <- list("Data", "Vieta", "Ivykiai", "Neblaivus", "Diena", "Moteris", "Asfaltas", "Zvyras", "Slapia_danga", "Giedra")
lyginamivyk <- sapply(tukstgyv, median)
lyginamivyk
lyginamivyk <- sapply(metiniai, miestai)
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum(diena)/sum(Kaltas), sum(moteris), sum(asfaltas), sum(zvyras), sum(slapia), sum(giedra))
colnames(metiniai) <- list("Data", "Vieta", "Ivykiai", "Neblaivus", "Diena", "Moteris", "Asfaltas", "Zvyras", "Slapia_danga", "Giedra")
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum(diena)/sum(Kaltas), sum(moteris), sum(asfaltas)/sum(Kaltas), sum(zvyras), sum(slapia), sum(giedra))
colnames(metiniai) <- list("Data", "Vieta", "Ivykiai", "Neblaivus", "Diena", "Moteris", "Asfaltas", "Zvyras", "Slapia_danga", "Giedra")
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum(diena)/sum(Kaltas), sum(moteris), sum(asfaltas)/sum(Kaltas), sum(zvyras), sum(slapia)/sum(Kaltas), sum(giedra))
colnames(metiniai) <- list("Data", "Vieta", "Ivykiai", "Neblaivus", "Diena", "Moteris", "Asfaltas", "Zvyras", "Slapia_danga", "Giedra")
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum(diena)/sum(Kaltas), sum(moteris)/sum(Kaltas), sum(asfaltas)/sum(Kaltas), sum(zvyras)/sum(Kaltas), sum(slapia)/sum(Kaltas), sum(giedra)/sum(Kaltas))
colnames(metiniai) <- list("Data", "Vieta", "Ivykiai", "Neblaivus", "Diena", "Moteris", "Asfaltas", "Zvyras", "Slapia_danga", "Giedra")
miestaihomo <- metinai$Vieta %in% miestai
miestaihomo <- metiniai$Vieta %in% miestai
miestaihomo <- metiniai[metiniai$Vieta %in% miestai, 5:10]
View(miestaihomo)
miestaihomo$miestai <- metiniai[metiniai$Vieta %in% miestai, 5:10]
View(metiniai)
miestaihomo[1] <- metiniai[metiniai$Vieta %in% miestai[i], 5:10]
for(i in 1:5)
miestaihomo[i] <- metiniai[metiniai$Vieta %in% miestai[i], 5:10]
for(i in 1:5)
miestaihomo[,i] <- metiniai[metiniai$Vieta %in% miestai[i], 5:10]
for(i in 1:5)
miestaihomo$i <- metiniai[metiniai$Vieta %in% miestai[i], 5:10]
View(miestaihomo)
vln <- metiniai[metiniai$Vieta == "Vilniaus m. sav.", 5:10]
View(vln)
salinamieji <- c("Lytis", "Apgadintu_transporto_priemoniu_skaicius", "Pilietybe", "Neigalumas", "Blaivumas", "Amzius")
ndata <- data[complete.cases(data[salinamieji]),]
sapply(lapply(data, is.na), sum)
salinamieji <- c("Lytis", "Apgadintu_transporto_priemoniu_skaicius", "Pilietybe", "Neigalumas", "Blaivumas", "Amzius")
ndata <- data[complete.cases(data[salinamieji]),]
sapply(lapply(ndata, is.na), sum)
tukst <- gyventojai[,3]/1000
gyventojai <- cbind(gyventojai, tukst)
diena <- data$Paros_metas == "Diena"
diena <- diena * 1
moteris <- data$Lytis == "Moteris"
moteris <- moteris * 1
asfaltas <- data$Dangos_rusis == "Asfaltbetonis, cementbetonis"
asfaltas <- asfaltas * 1
zvyras <- data$Dangos_rusis == "zvyrkelis"
zvyras <- zvyras * 1
slapia <- data$Dangos_bukle == "slapia"
slapia <- slapia * 1
giedra <- data$Meteorologines_salygos == "Giedra"
giedra <- giedra * 1
ndata <- cbind(ndata, diena, moteris, asfaltas, zvyras, slapia, giedra)
rawdata <- read.csv2("2003-2015.csv", header = T)
gyventojai <- read.csv2("gyventojai.csv", header = T, skip = 1)
kor <- read.csv2("koreliacijos.csv", header = T)
miestai <- c("Vilniaus m. sav.", "Kauno m. sav.", "Klaipedos m. sav.", "Siauliu m. sav.", "Panevezio m. sav.")
data <- subset(rawdata, Vieta %in% miestai)
Amzius <- as.numeric(format(Sys.Date(), format="%Y")) - as.numeric(format(as.Date(data$Gimimo_data, format="%Y"), format = "%Y"))
data <- cbind(data, Amzius)
data[data[, "Blaivumas"] %in% c("Apsvaiges nuo narkotiniu, psichotropiniu ar kitu psichika veikianciu medziagu", "Atsisake buti patikrintas", "Neblaivus"), "Blaivumas"] <- "Neblaivus"
data$Blaivumas <- factor(data$Blaivumas)
table(data$Blaivumas)
data[data[, "Meteorologines_salygos"] == "Lijundra", "Meteorologines_salygos"] <- "Lietus"
data[data[, "Meteorologines_salygos"] == "Puga", "Meteorologines_salygos"] <- "Sniegas, krusa"
data$Meteorologines_salygos <- factor(data$Meteorologines_salygos)
table(data$Meteorologines_salygos)
salinamieji <- c("Lytis", "Apgadintu_transporto_priemoniu_skaicius", "Pilietybe", "Neigalumas", "Blaivumas", "Amzius")
ndata <- data[complete.cases(data[salinamieji]),]
sapply(lapply(ndata, is.na), sum)
tukst <- gyventojai[,3]/1000
gyventojai <- cbind(gyventojai, tukst)
diena <- ndata$Paros_metas == "Diena"
diena <- diena * 1
moteris <- ndata$Lytis == "Moteris"
moteris <- moteris * 1
asfaltas <- ndata$Dangos_rusis == "Asfaltbetonis, cementbetonis"
asfaltas <- asfaltas * 1
zvyras <- ndata$Dangos_rusis == "zvyrkelis"
zvyras <- zvyras * 1
slapia <- ndata$Dangos_bukle == "slapia"
slapia <- slapia * 1
giedra <- ndata$Meteorologines_salygos == "Giedra"
giedra <- giedra * 1
ndata <- cbind(ndata, diena, moteris, asfaltas, zvyras, slapia, giedra)
View(ndata)
sum(is.na(ndata[,28:34]))
sum(is.na(ndata[,27:34]))
by_year <- group_by(ndata, format(as.Date(ndata$Data, format="%Y-%m-%d"),"%Y"), Vieta)
metiniai <- summarise(by_year, sum(Kaltas), sum(data$Blaivumas == "Neblaivus", na.rm=T), sum(diena)/sum(Kaltas), sum(moteris)/sum(Kaltas), sum(asfaltas)/sum(Kaltas), sum(zvyras)/sum(Kaltas), sum(slapia)/sum(Kaltas), sum(giedra)/sum(Kaltas))
colnames(metiniai) <- list("Data", "Vieta", "Ivykiai", "Neblaivus", "Diena", "Moteris", "Asfaltas", "Zvyras", "Slapia_danga", "Giedra")
View(metiniai)
for(i in 1:5)
vln <- metiniai[metiniai$Vieta == "Vilniaus m. sav.", 5:10]
View(vln)
vln[1]
vilnius <- metiniai[metiniai$Vieta == "Vilniaus m. sav.", 5:10]
kaunas <- metiniai[metiniai$Vieta == "Kauno m. sav.", 5:10]
siauliai <- metiniai[metiniai$Vieta == "Siauliu m. sav.", 5:10]
panevezys <- metiniai[metiniai$Vieta == "Panevezio m. sav.", 5:10]
klaipeda <- metiniai[metiniai$Vieta == "Klaipedos m. sav.", 5:10]
View(siauliai)
chisq.test(vilnius[1], kaunas[1])
kaunas[1]
vilnius[1]
chisq.test(vilnius[1], kaunas[1])
kaunas[1,1]
kaunas[1,2]
kaunas[2,2]
as.vector(vilnius[1])
length(kaunas[,1])
length(vilnius[1])
vilnius <- data.frame(metiniai[metiniai$Vieta == "Vilniaus m. sav.", 5:10])
View(vilnius)
vilnius[1]
kaunas <- data.frame(metiniai[metiniai$Vieta == "Kauno m. sav.", 5:10])
chisq.test(vilnius[1], kaunas[,1])
chisq.test(vilnius[i], kaunas[i])
for(i in 1:6)
chisq.test(vilnius[i], kaunas[i])
vilnius <- data.frame(metiniai[metiniai$Vieta == "Vilniaus m. sav.", 5:10])
kaunas <- data.frame(metiniai[metiniai$Vieta == "Kauno m. sav.", 5:10])
kaunas[1]
chisq.test(vilnius[1], kaunas[1])
vilnius[1]
vilnius[1,1]
vilnius[1,1:13]
vilnius[1:13,1]
vilnius[,1], kaunas[,1]
vilnius[,1]
chisq.test(vilnius[,1], kaunas[,1])
for(i in 1:6)
chisq.test(vilnius[,i], kaunas[,i])
