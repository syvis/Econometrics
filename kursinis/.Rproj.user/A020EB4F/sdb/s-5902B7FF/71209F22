{
    "collab_server" : "",
    "contents" : "plot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.1,0.5), yaxs=\"i\", xaxs=\"i\", main = \"Eismo įvykių dalis ant šlapios dangos\", ylab = \"Įvykių sk.\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_slapia[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topright\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1)\n#negiedra\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.2,0.7), yaxs=\"i\", xaxs=\"i\", main = \"Eismo įvykių dalis, kai negiedras dangus\", ylab = \"Įvykių sk.\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_negiedra[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topleft\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1)\n#Proporciju grafikai kiekvienam kintamajam\n#neblaivus\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0, 0.3), yaxs=\"i\", xaxs=\"i\", main = \"Įvykių sk. dalis dėl neblaivių vairuotojų kaltės\", ylab = \"Įvykių sk. dalis\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_neblaivus[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topleft\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, cex = 0.45, text.width = 1)\n#naktis\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.1,0.5), yaxs=\"i\", xaxs=\"i\", main = \"Naktį sukeltų eismo įvykių dalis\", ylab = \"Įvykių sk.\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_naktis[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topright\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, cex = 0.45, text.width = 1)\n#moterys\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.1,0.4), yaxs=\"i\", xaxs=\"i\", main = \"Moterų sukeltų eismo įvykių dalis\", ylab = \"Įvykių sk.\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_moteris[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topleft\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1)\n#slapia danga\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.1,0.5), yaxs=\"i\", xaxs=\"i\", main = \"Eismo įvykių dalis ant šlapios dangos\", ylab = \"Įvykių sk.\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_slapia[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topright\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1)\n#negiedra\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.2,0.7), yaxs=\"i\", xaxs=\"i\", main = \"Eismo įvykių dalis, kai negiedras dangus\", ylab = \"Įvykių sk.\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_negiedra[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topleft\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1)\n#Proporciju grafikai kiekvienam kintamajam\n#neblaivus\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0, 0.3), yaxs=\"i\", xaxs=\"i\", main = \"Įvykių sk. dalis dėl neblaivių vairuotojų kaltės\", ylab = \"Įvykių sk. dalis\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_neblaivus[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topleft\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, cex = 0.45, text.width = 1)\n#naktis\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.1,0.5), yaxs=\"i\", xaxs=\"i\", main = \"Naktį sukeltų eismo įvykių dalis\", ylab = \"Įvykių sk.\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_naktis[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topright\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, cex = 0.45, text.width = 1)\n#moterys\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.1,0.4), yaxs=\"i\", xaxs=\"i\", main = \"Moterų sukeltų eismo įvykių dalis\", ylab = \"Įvykių sk.\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_moteris[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topleft\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1)\n#slapia danga\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.1,0.5), yaxs=\"i\", xaxs=\"i\", main = \"Eismo įvykių dalis ant šlapios dangos\", ylab = \"Įvykių sk.\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_slapia[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topright\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1, y.intersp = 0.6)\n#negiedra\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.2,0.7), yaxs=\"i\", xaxs=\"i\", main = \"Eismo įvykių dalis, kai negiedras dangus\", ylab = \"Įvykių sk.\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_negiedra[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topleft\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1)\nlenteles <- function(i)\nmatrix(c(as.matrix(met[met$Vieta == \"Vilniaus m. sav.\", i]), as.matrix(met[met$Vieta == \"Kauno m. sav.\", i]), as.matrix(met[met$Vieta == \"Klaipedos m. sav.\", i]), as.matrix(met[met$Vieta == \"Siauliu m. sav.\", i]), as.matrix(met[met$Vieta == \"Panevezio m. sav.\", i])), byrow = T)\nlentele <- data.frame(sapply(kintamieji, lenteles))\nView(prop_met)\nmatrix(c(as.matrix(prop_met[prop_met$Vieta == \"Vilniaus m. sav.\", i]), as.matrix(prop_met[prop_met$Vieta == \"Kauno m. sav.\", i]), as.matrix(prop_met[prop_met$Vieta == \"Klaipedos m. sav.\", i]), as.matrix(prop_met[prop_met$Vieta == \"Siauliu m. sav.\", i]), as.matrix(prop_met[prop_met$Vieta == \"Panevezio m. sav.\", i])), byrow = T)\nlenteles <- function(i)\nmatrix(c(as.matrix(prop_met[prop_met$Vieta == \"Vilniaus m. sav.\", i]), as.matrix(prop_met[prop_met$Vieta == \"Kauno m. sav.\", i]), as.matrix(prop_met[prop_met$Vieta == \"Klaipedos m. sav.\", i]), as.matrix(prop_met[prop_met$Vieta == \"Siauliu m. sav.\", i]), as.matrix(prop_met[prop_met$Vieta == \"Panevezio m. sav.\", i])), byrow = T)\nlentele <- data.frame(sapply(kintamieji, lenteles))\nView(lentele)\nwarnings()\nlenteles <- function(i)\nmatrix(c(as.matrix(prop_metviet[prop_metviet$Vieta == \"Vilniaus m. sav.\", i]), as.matrix(prop_metviet[prop_metviet$Vieta == \"Kauno m. sav.\", i]), as.matrix(prop_metviet[prop_metviet$Vieta == \"Klaipedos m. sav.\", i]), as.matrix(prop_metviet[prop_metviet$Vieta == \"Siauliu m. sav.\", i]), as.matrix(prop_metviet[prop_metviet$Vieta == \"Panevezio m. sav.\", i])), byrow = T)\nlentele <- data.frame(sapply(kintamieji, lenteles))\nView(lentele)\n# Chunk 1\nlibrary(fpp)\nlibrary(dplyr)\n# Chunk 2\nrawdata <- read.csv2(\"2003-2015.csv\", header = T)\ngyventojai <- read.csv2(\"gyventojai.csv\", header = T, skip = 1)\nkor <- read.csv2(\"koreliacijos.csv\", header = T)\n# Chunk 3\nmiestai <- c(\"Vilniaus m. sav.\", \"Kauno m. sav.\", \"Klaipedos m. sav.\", \"Siauliu m. sav.\", \"Panevezio m. sav.\")\ndata <- subset(rawdata, Vieta %in% miestai)\n# Chunk 4\nAmzius <- as.numeric(format(Sys.Date(), format=\"%Y\")) - as.numeric(format(as.Date(data$Gimimo_data, format=\"%Y\"), format = \"%Y\"))\ndata <- cbind(data, Amzius)\n# Chunk 5\n#sum(is.na(data$Stazas))\n#sum(is.na(data$Amzius))\n#cor(data$Amzius, data$Stazas, use = \"pairwise.complete.obs\")\n# Chunk 6\ndata[data[, \"Blaivumas\"] %in% c(\"Apsvaiges nuo narkotiniu, psichotropiniu ar kitu psichika veikianciu medziagu\", \"Atsisake buti patikrintas\", \"Neblaivus\"), \"Blaivumas\"] <- \"Neblaivus\"\ndata$Blaivumas <- factor(data$Blaivumas)\n#table(data$Blaivumas)\n# Chunk 7\ndata[data[, \"Meteorologines_salygos\"] == \"Lijundra\", \"Meteorologines_salygos\"] <- \"Lietus\"\ndata[data[, \"Meteorologines_salygos\"] == \"Puga\", \"Meteorologines_salygos\"] <- \"Sniegas, krusa\"\ndata$Meteorologines_salygos <- factor(data$Meteorologines_salygos)\n#table(data$Meteorologines_salygos)\n# Chunk 8\nsalinamieji <- c(\"Lytis\", \"Blaivumas\")\nndata <- data[complete.cases(data[salinamieji]),]\n#sapply(lapply(ndata, is.na), sum)\n# Chunk 9\nby_month <- group_by(data, format(as.Date(data$Data, format=\"%Y-%m-%d\"),\"%Y-%m\"), Vieta)\nagreguoti <- summarise(by_month, sum(Kaltas), sum(Dalyviu_skaicius), sum(Suzeistu_skaicius), sum(Zuvusiu_skaicius))\ncolnames(agreguoti) <- list(\"Data\", \"Vieta\", \"Ivykiai\", \"Dalyviai\", \"Suzeisti\", \"Zuve\")\n# Chunk 10\nivykiusk <- function(i)\nts(agreguoti[agreguoti$Vieta == i, \"Ivykiai\"], start=c(2003,1), frequency = 12)\ngyvsk <- function(i)\nts(rep(gyventojai[gyventojai$Vieta == i, \"Visi\"], each = 12), start = c(2003,1), frequency = 12)\nivykiai <- sapply(miestai, ivykiusk)\nnames(ivykiai)<-sprintf(miestai)\ngyven <- sapply(miestai, gyvsk)\nnames(gyven)<-sprintf(miestai)\ntukst <- function(i)\nivykiai[,i] * 1000 / gyven[,i]\ntukstgyv <- ts(sapply(miestai, tukst), start = c(2003,1), frequency = 12)\nnames(tukstgyv)<-sprintf(miestai)\n# Chunk 11\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0,0.3), yaxs=\"i\", xaxs=\"i\", main = \"Įvykių skaičius 1000-iui gyventojų\", ylab = \"Įvykių sk. 1000 gyv.\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(tukstgyv[,i], col = i, lwd = 1)\nlegend(\"topright\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1)\n# Chunk 12\n#kintamuju kurimas\nneblaivus <- ndata$Blaivumas == \"Neblaivus\"\nneblaivus <- neblaivus * 1\ndiena <- ndata$Paros_metas == \"Diena\"\ndiena <- diena * 1\nmoteris <- ndata$Lytis == \"Moteris\"\nmoteris <- moteris * 1\nslapia <- ndata$Dangos_bukle == \"slapia\"\nslapia <- slapia * 1\ngiedra <- ndata$Meteorologines_salygos == \"Giedra\"\ngiedra <- giedra * 1\nndata <- cbind(ndata, neblaivus, diena, moteris, slapia, giedra)\nkintamieji <- c(\"Neblaivus\", \"Naktis\", \"Moteris\", \"Slapia_danga\", \"Negiedra\")\n# Chunk 13\n#Proporciju lenteliu grupavimas by:\nby_metmenviet <- group_by(ndata, format(as.Date(ndata$Data, format=\"%Y-%m-%d\"), \"%Y-%m\"), Vieta)\nby_metviet <- group_by(ndata, format(as.Date(ndata$Data, format=\"%Y-%m-%d\"), \"%Y\"), Vieta)\nby_met <- group_by(ndata, format(as.Date(ndata$Data, format=\"%Y-%m-%d\"), \"%Y\"))\nby_men <- group_by(ndata, format(as.Date(ndata$Data, format=\"%Y-%m-%d\"), \"%m\"))\n# Chunk 14\n#Proporciju lenteliu kurimas su 5 kintamaisiais\nprop_metmenviet <- summarise(by_metmenviet, sum(Kaltas), sum(neblaivus)/sum(Kaltas), 1 - sum(diena)/sum(Kaltas), sum(moteris)/sum(Kaltas), sum(slapia)/sum(Kaltas), 1 - sum(giedra)/sum(Kaltas))\nprop_metviet <- summarise(by_metviet, sum(Kaltas), sum(neblaivus)/sum(Kaltas), 1 - sum(diena)/sum(Kaltas), sum(moteris)/sum(Kaltas), sum(slapia)/sum(Kaltas), 1 - sum(giedra)/sum(Kaltas))\nprop_met <- summarise(by_met, sum(Kaltas), sum(neblaivus)/sum(Kaltas), 1 - sum(diena)/sum(Kaltas), sum(moteris)/sum(Kaltas), sum(slapia)/sum(Kaltas), 1 - sum(giedra)/sum(Kaltas))\nprop_men <- summarise(by_men, sum(Kaltas), sum(neblaivus)/sum(Kaltas), 1 - sum(diena)/sum(Kaltas), sum(moteris)/sum(Kaltas), sum(slapia)/sum(Kaltas), 1 - sum(giedra)/sum(Kaltas))\ncolnames(prop_metmenviet) <- c(\"Data\", \"Vieta\", \"Ivykiai\", kintamieji)\ncolnames(prop_metviet) <- c(\"Metai\", \"Vieta\", \"Ivykiai\", kintamieji)\ncolnames(prop_met) <- c(\"Metai\", \"Ivykiai\", kintamieji)\ncolnames(prop_men) <- c(\"Menuo\", \"Ivykiai\", kintamieji)\n# Chunk 15\n#Proporciju lenteliu kurimas kiekvienam kintamajam su 5 miestais\nfunk_kint <- function(i, j)\nts(prop_metmenviet[prop_metmenviet[, \"Vieta\"] == i, j], start = c(2003,1), frequency = 12)\nlent_neblaivus <- sapply(miestai, funk_kint, \"Neblaivus\")\nlent_naktis <- sapply(miestai, funk_kint, \"Naktis\")\nlent_moteris <- sapply(miestai, funk_kint, \"Moteris\")\nlent_slapia <- sapply(miestai, funk_kint, \"Slapia_danga\")\nlent_negiedra <- sapply(miestai, funk_kint, \"Negiedra\")\n# Chunk 16\n#Proporciju grafikai kiekvienam kintamajam\n#neblaivus\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0, 0.3), yaxs=\"i\", xaxs=\"i\", main = \"Neblaivių vairuotojų sukeltų įvykių dalis\", ylab = \"Įvykių sk. dalis\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_neblaivus[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topleft\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, cex = 0.45, text.width = 1)\n#naktis\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.1,0.5), yaxs=\"i\", xaxs=\"i\", main = \"Naktį sukeltų eismo įvykių dalis\", ylab = \"Įvykių sk. dalis\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_naktis[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topright\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, cex = 0.45, text.width = 1)\n#moterys\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.1,0.4), yaxs=\"i\", xaxs=\"i\", main = \"Moterų sukeltų eismo įvykių dalis\", ylab = \"Įvykių sk. dalis\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_moteris[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topleft\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1)\n#slapia danga\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.1,0.5), yaxs=\"i\", xaxs=\"i\", main = \"Eismo įvykių dalis ant šlapios dangos\", ylab = \"Įvykių sk. dalis\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_slapia[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topright\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1, y.intersp = 0.6)\n#negiedra\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.2,0.7), yaxs=\"i\", xaxs=\"i\", main = \"Eismo įvykių dalis, kai negiedras dangus\", ylab = \"Įvykių sk. dalis\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_negiedra[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topleft\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1)\nlenteles <- function(i)\nmatrix(c(as.matrix(prop_metviet[prop_metviet$Vieta == \"Vilniaus m. sav.\", i]), as.matrix(prop_metviet[prop_metviet$Vieta == \"Kauno m. sav.\", i]), as.matrix(prop_metviet[prop_metviet$Vieta == \"Klaipedos m. sav.\", i]), as.matrix(prop_metviet[prop_metviet$Vieta == \"Siauliu m. sav.\", i]), as.matrix(prop_metviet[prop_metviet$Vieta == \"Panevezio m. sav.\", i])), byrow = T)\nlentele <- data.frame(sapply(kintamieji, lenteles))\nView(lentele)\nView(prop_metviet)\ncolnames(lentele) <- kintamieji\n# Chunk 1\nlibrary(fpp)\nlibrary(dplyr)\n# Chunk 2\nrawdata <- read.csv2(\"2003-2015.csv\", header = T)\ngyventojai <- read.csv2(\"gyventojai.csv\", header = T, skip = 1)\nkor <- read.csv2(\"koreliacijos.csv\", header = T)\n# Chunk 3\nmiestai <- c(\"Vilniaus m. sav.\", \"Kauno m. sav.\", \"Klaipedos m. sav.\", \"Siauliu m. sav.\", \"Panevezio m. sav.\")\ndata <- subset(rawdata, Vieta %in% miestai)\n# Chunk 4\nAmzius <- as.numeric(format(Sys.Date(), format=\"%Y\")) - as.numeric(format(as.Date(data$Gimimo_data, format=\"%Y\"), format = \"%Y\"))\ndata <- cbind(data, Amzius)\n# Chunk 5\n#sum(is.na(data$Stazas))\n#sum(is.na(data$Amzius))\n#cor(data$Amzius, data$Stazas, use = \"pairwise.complete.obs\")\n# Chunk 6\ndata[data[, \"Blaivumas\"] %in% c(\"Apsvaiges nuo narkotiniu, psichotropiniu ar kitu psichika veikianciu medziagu\", \"Atsisake buti patikrintas\", \"Neblaivus\"), \"Blaivumas\"] <- \"Neblaivus\"\ndata$Blaivumas <- factor(data$Blaivumas)\n#table(data$Blaivumas)\n# Chunk 7\ndata[data[, \"Meteorologines_salygos\"] == \"Lijundra\", \"Meteorologines_salygos\"] <- \"Lietus\"\ndata[data[, \"Meteorologines_salygos\"] == \"Puga\", \"Meteorologines_salygos\"] <- \"Sniegas, krusa\"\ndata$Meteorologines_salygos <- factor(data$Meteorologines_salygos)\n#table(data$Meteorologines_salygos)\n# Chunk 8\nsalinamieji <- c(\"Lytis\", \"Blaivumas\")\nndata <- data[complete.cases(data[salinamieji]),]\n#sapply(lapply(ndata, is.na), sum)\n# Chunk 9\nby_month <- group_by(data, format(as.Date(data$Data, format=\"%Y-%m-%d\"),\"%Y-%m\"), Vieta)\nagreguoti <- summarise(by_month, sum(Kaltas), sum(Dalyviu_skaicius), sum(Suzeistu_skaicius), sum(Zuvusiu_skaicius))\ncolnames(agreguoti) <- list(\"Data\", \"Vieta\", \"Ivykiai\", \"Dalyviai\", \"Suzeisti\", \"Zuve\")\n# Chunk 10\nivykiusk <- function(i)\nts(agreguoti[agreguoti$Vieta == i, \"Ivykiai\"], start=c(2003,1), frequency = 12)\ngyvsk <- function(i)\nts(rep(gyventojai[gyventojai$Vieta == i, \"Visi\"], each = 12), start = c(2003,1), frequency = 12)\nivykiai <- sapply(miestai, ivykiusk)\nnames(ivykiai)<-sprintf(miestai)\ngyven <- sapply(miestai, gyvsk)\nnames(gyven)<-sprintf(miestai)\ntukst <- function(i)\nivykiai[,i] * 1000 / gyven[,i]\ntukstgyv <- ts(sapply(miestai, tukst), start = c(2003,1), frequency = 12)\nnames(tukstgyv)<-sprintf(miestai)\n# Chunk 11\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0,0.3), yaxs=\"i\", xaxs=\"i\", main = \"Įvykių skaičius 1000-iui gyventojų\", ylab = \"Įvykių sk. 1000 gyv.\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(tukstgyv[,i], col = i, lwd = 1)\nlegend(\"topright\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1)\n# Chunk 12\n#kintamuju kurimas\nneblaivus <- ndata$Blaivumas == \"Neblaivus\"\nneblaivus <- neblaivus * 1\ndiena <- ndata$Paros_metas == \"Diena\"\ndiena <- diena * 1\nmoteris <- ndata$Lytis == \"Moteris\"\nmoteris <- moteris * 1\nslapia <- ndata$Dangos_bukle == \"slapia\"\nslapia <- slapia * 1\ngiedra <- ndata$Meteorologines_salygos == \"Giedra\"\ngiedra <- giedra * 1\nndata <- cbind(ndata, neblaivus, diena, moteris, slapia, giedra)\nkintamieji <- c(\"Neblaivus\", \"Naktis\", \"Moteris\", \"Slapia_danga\", \"Negiedra\")\n# Chunk 13\n#Proporciju lenteliu grupavimas by:\nby_metmenviet <- group_by(ndata, format(as.Date(ndata$Data, format=\"%Y-%m-%d\"), \"%Y-%m\"), Vieta)\nby_metviet <- group_by(ndata, format(as.Date(ndata$Data, format=\"%Y-%m-%d\"), \"%Y\"), Vieta)\nby_met <- group_by(ndata, format(as.Date(ndata$Data, format=\"%Y-%m-%d\"), \"%Y\"))\nby_men <- group_by(ndata, format(as.Date(ndata$Data, format=\"%Y-%m-%d\"), \"%m\"))\n# Chunk 14\n#Proporciju lenteliu kurimas su 5 kintamaisiais\nprop_metmenviet <- summarise(by_metmenviet, sum(Kaltas), sum(neblaivus)/sum(Kaltas), 1 - sum(diena)/sum(Kaltas), sum(moteris)/sum(Kaltas), sum(slapia)/sum(Kaltas), 1 - sum(giedra)/sum(Kaltas))\nprop_metviet <- summarise(by_metviet, sum(Kaltas), sum(neblaivus)/sum(Kaltas), 1 - sum(diena)/sum(Kaltas), sum(moteris)/sum(Kaltas), sum(slapia)/sum(Kaltas), 1 - sum(giedra)/sum(Kaltas))\nprop_met <- summarise(by_met, sum(Kaltas), sum(neblaivus)/sum(Kaltas), 1 - sum(diena)/sum(Kaltas), sum(moteris)/sum(Kaltas), sum(slapia)/sum(Kaltas), 1 - sum(giedra)/sum(Kaltas))\nprop_men <- summarise(by_men, sum(Kaltas), sum(neblaivus)/sum(Kaltas), 1 - sum(diena)/sum(Kaltas), sum(moteris)/sum(Kaltas), sum(slapia)/sum(Kaltas), 1 - sum(giedra)/sum(Kaltas))\ncolnames(prop_metmenviet) <- c(\"Data\", \"Vieta\", \"Ivykiai\", kintamieji)\ncolnames(prop_metviet) <- c(\"Metai\", \"Vieta\", \"Ivykiai\", kintamieji)\ncolnames(prop_met) <- c(\"Metai\", \"Ivykiai\", kintamieji)\ncolnames(prop_men) <- c(\"Menuo\", \"Ivykiai\", kintamieji)\n# Chunk 15\n#Proporciju lenteliu kurimas kiekvienam kintamajam su 5 miestais\nfunk_kint <- function(i, j)\nts(prop_metmenviet[prop_metmenviet[, \"Vieta\"] == i, j], start = c(2003,1), frequency = 12)\nlent_neblaivus <- sapply(miestai, funk_kint, \"Neblaivus\")\nlent_naktis <- sapply(miestai, funk_kint, \"Naktis\")\nlent_moteris <- sapply(miestai, funk_kint, \"Moteris\")\nlent_slapia <- sapply(miestai, funk_kint, \"Slapia_danga\")\nlent_negiedra <- sapply(miestai, funk_kint, \"Negiedra\")\n# Chunk 16\n#Proporciju grafikai kiekvienam kintamajam\n#neblaivus\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0, 0.3), yaxs=\"i\", xaxs=\"i\", main = \"Neblaivių vairuotojų sukeltų įvykių dalis\", ylab = \"Įvykių sk. dalis\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_neblaivus[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topleft\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, cex = 0.45, text.width = 1)\n#naktis\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.1,0.5), yaxs=\"i\", xaxs=\"i\", main = \"Naktį sukeltų eismo įvykių dalis\", ylab = \"Įvykių sk. dalis\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_naktis[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topright\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, cex = 0.45, text.width = 1)\n#moterys\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.1,0.4), yaxs=\"i\", xaxs=\"i\", main = \"Moterų sukeltų eismo įvykių dalis\", ylab = \"Įvykių sk. dalis\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_moteris[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topleft\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1)\n#slapia danga\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.1,0.5), yaxs=\"i\", xaxs=\"i\", main = \"Eismo įvykių dalis ant šlapios dangos\", ylab = \"Įvykių sk. dalis\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_slapia[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topright\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1, y.intersp = 0.6)\n#negiedra\nplot(0, type = \"n\", xlim = c(2003,2015), ylim = c(0.2,0.7), yaxs=\"i\", xaxs=\"i\", main = \"Eismo įvykių dalis, kai negiedras dangus\", ylab = \"Įvykių sk. dalis\", xlab = \"Laikas\", axes=F)\npar(xaxp=c(2003, 2015, 12))\naxis(1)\naxis(2, at = seq(0,1,by=.1), labels = paste(100*seq(0,1,by=.1), \"%\"))\nfor(i in 1:length(miestai))\nlines(stl(ts((lent_negiedra[,i]), start = c(2003,1), frequency = 12), s.window = \"periodic\")$time.series[,2], col = i, lwd = 1)\nlegend(\"topleft\", col = c(1:5), lty = 1, lwd = 1, legend = miestai, pt.cex = 1, cex = 0.45, text.width = 1)\nlenteles <- function(i)\nmatrix(c(as.matrix(prop_metviet[prop_metviet$Vieta == \"Vilniaus m. sav.\", i]), as.matrix(prop_metviet[prop_metviet$Vieta == \"Kauno m. sav.\", i]), as.matrix(prop_metviet[prop_metviet$Vieta == \"Klaipedos m. sav.\", i]), as.matrix(prop_metviet[prop_metviet$Vieta == \"Siauliu m. sav.\", i]), as.matrix(prop_metviet[prop_metviet$Vieta == \"Panevezio m. sav.\", i])), byrow = T)\nlentele <- data.frame(sapply(kintamieji, lenteles))\nView(lentele)\nmetai <- as.factor(rep(rep(2003:2015), 5))\nneblaivumas <- lentele$Neblaivus\nmod1 <- aov(neblaivumas ~ miestas)\nmiestas <- as.factor(rep(1:5, each = 65))\nlentele <- data.frame(sapply(kintamieji, lenteles))\nmetai <- as.factor(rep(rep(2003:2015), 5))\nmiestas <- as.factor(rep(1:5, each = 65))\ndata.frame(metai, miestas, lentele)\ndata.frame(metai, miestas, lentele$Neblaivus)\nView(prop_metviet)\nlentele$Neblaivus\nneblaivumas <- lentele$Neblaivus\nlentele <- data.frame(sapply(kintamieji, lenteles))\nmetai <- as.factor(rep(rep(2003:2015), 5))\nmiestas <- as.factor(rep(1:5, each = 13))\ndata.frame(metai, miestas, lentele$Neblaivus)\nneblaivumas <- lentele$Neblaivus\nmod1 <- aov(neblaivumas ~ miestas)\nanova(mod1)\ndienos_metas <- lentele$Diena\nmod2 <- aov(neblaiv ~ miestas)\nanova(mod1)\nmoterys <- lentele$Moteris\nmod3 <- aov(neblaiv ~ miestas)\nanova(mod1)\nslapia_danga <- lentele$Slapia_danga\nmod4 <- aov(neblaiv ~ miestas)\nanova(mod1)\ngiedras <- lentele$Giedra\nmod5 <- aov(neblaiv ~ miestas)\nanova(mod1)\nneblaivumas <- lentele$Neblaivus\nmod1 <- aov(neblaivumas ~ miestas)\nanova(mod1)\ndienos_metas <- lentele$Diena\nmod2 <- aov(dienos_metas ~ miestas)\nanova(mod1)\nmoterys <- lentele$Moteris\nmod3 <- aov(moterys ~ miestas)\nanova(mod1)\nslapia_danga <- lentele$Slapia_danga\nmod4 <- aov(slapia_danga ~ miestas)\nanova(mod1)\ngiedras <- lentele$Giedra\nmod5 <- aov(giedras ~ miestas)\nanova(mod1)\n#blokuoti anova\nneblaivumas <- lentele$Neblaivus\nmod1 <- aov(neblaivumas ~ miestas)\nanova(mod1)\nnakties_metas <- lentele$Naktis\nmod2 <- aov(dienos_metas ~ miestas)\nanova(mod1)\nmoterys <- lentele$Moteris\nmod3 <- aov(moterys ~ miestas)\nanova(mod1)\nslapia_danga <- lentele$Slapia_danga\nmod4 <- aov(slapia_danga ~ miestas)\nanova(mod1)\nnegiedras <- lentele$Negiedra\nmod5 <- aov(giedras ~ miestas)\nanova(mod1)\n#blokuoti anova\nneblaivumas <- lentele$Neblaivus\nmod1 <- aov(neblaivumas ~ miestas)\nanova(mod1)\nnakties_metas <- lentele$Naktis\nmod2 <- aov(dienos_metas ~ miestas)\nanova(mod2)\nmoterys <- lentele$Moteris\nmod3 <- aov(moterys ~ miestas)\nanova(mod3)\nslapia_danga <- lentele$Slapia_danga\nmod4 <- aov(slapia_danga ~ miestas)\nanova(mod4)\nnegiedras <- lentele$Negiedra\nmod5 <- aov(giedras ~ miestas)\nanova(mod5)\nneblaivumas <- lentele$Neblaivus\nmod1 <- aov(neblaivumas ~ miestas)\nanova(mod1)\nnakties_metas <- lentele$Naktis\nmod2 <- aov(dienos_metas ~ miestas)\nanova(mod2)\n#blokuoti anova\nneblaivumas <- lentele$Neblaivus\nmod1 <- aov(neblaivumas ~ miestas)\nanova(mod1)\nnakties_metas <- lentele$Naktis\nmod2 <- aov(nakties_metas ~ miestas)\nanova(mod2)\nmoterys <- lentele$Moteris\nmod3 <- aov(moterys ~ miestas)\nanova(mod3)\nslapia_danga <- lentele$Slapia_danga\nmod4 <- aov(slapia_danga ~ miestas)\nanova(mod4)\nnegiedras <- lentele$Negiedra\nmod5 <- aov(negiedras ~ miestas)\nanova(mod5)\nTukeyHSD(mod1)\nTukeyHSD(mod1)[1]\nstr(TukeyHSD(mod1))\nTukeyHSD(mod1)\nTukeyHSD(mod1)[,4]\nTukeyHSD(mod1)[4]\nTukeyHSD(mod1)$miestas\nTukeyHSD(mod1)$miestas[,4]\nTukeyHSD(mod1)$miestas[miestas[,4] < 0.05]\nTukeyHSD(mod1)$miestas[miestas[,4] < 0.05,]\nTukeyHSD(mod1)$miestas\nTukeyHSD(mod1)$miestas[,4]\nTukeyHSD(mod1)$miestas[TukeyHSD(mod1)miestas[,4] < 0.05,]\nTukeyHSD(mod1)$miestas[TukeyHSD(mod1)$miestas[,4] < 0.05,]\nTukeyHSD(mod1)$miestas[TukeyHSD(mod1)$miestas[,4] < 0.05,]\nTukeyHSD(mod2)$miestas[TukeyHSD(mod2)$miestas[,4] < 0.05,]\nTukeyHSD(mod5)$miestas[TukeyHSD(mod5)$miestas[,4] < 0.05,]\nTukeyHSD(mod5)$miestas[TukeyHSD(mod5)$miestas[,4] < 0.05,]\nTukeyHSD(mod5)$miestas\n",
    "created" : 1478474703451.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2859349738",
    "id" : "71209F22",
    "lastKnownWriteTime" : 1478472821,
    "last_content_update" : 1478472821,
    "path" : "~/GitHub/Econometrics/kursinis/.Rhistory",
    "project_path" : ".Rhistory",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_history"
}